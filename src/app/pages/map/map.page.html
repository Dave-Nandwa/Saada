<!-- <ion-header transparent no-border>
  <ion-buttons slot="start">
    <ion-back-button></ion-back-button>
  </ion-buttons>
  <ion-toolbar>
    <ion-title text-center>Map</ion-title>
  </ion-toolbar>
</ion-header> -->


<ion-content fullscreen>



  <agm-map [styles]="mapStyles" [zoom]="zoomLevel" [disableDefaultUI]="true" [zoomControl]="false" [latitude]="lat"
    [longitude]="lng">

    <!-- -------------------------- Directions Markup -------------------------- -->
    <agm-direction *ngIf="origin && destination" [origin]="origin" [destination]="destination"
      [travelMode]="travelMode">
    </agm-direction>

    <!-- ----------------------------- User Marker ----------------------------- -->

    <agm-marker [latitude]="lat" [longitude]="lng" [label]="You" [iconUrl]="mapIcon"></agm-marker>

    <!-- Display Multiple Markers + An Info Window-->

    <agm-marker *ngFor="let point of points | async; trackBy: trackByFn" [latitude]="point.position.geopoint.latitude"
      [longitude]="point.position.geopoint.longitude"
      [iconUrl]="{ url: point.icon, scaledSize: {height: 40, width: 40} }">

      <agm-info-window [isOpen]="isInfoWindowOpen(point.spotId)">
        <ion-list>
          <ion-item><ion-label class="ion-text-wrap">Name: {{point.name}}</ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">Description: {{point.description}}</ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">Status: {{point.status}}</ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">Need: {{point.reason}}</ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">Category: Unknown</ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">Media File: <a href="#">{{point.mediaFile}}</a></ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">Updated at: {{point.when}}</ion-label></ion-item>
          <ion-item><ion-label class="ion-text-wrap">By: {{point.createdBy}}</ion-label></ion-item>
        </ion-list>
        <button expand="block" class="ion-padding btn"
          (click)="getDirections(point.position.geopoint.latitude, point.position.geopoint.longitude)">
          Navigate to
          <ion-ripple-effect></ion-ripple-effect>
        </button>
        <!-- {{ point.hitMetadata | json }} -->
      </agm-info-window>
    </agm-marker>



    <agm-circle [latitude]="lat" [longitude]="lng" [radius]="(radius | async)" [fillColor]="'rgb(79,101,246,0.7)'">
    </agm-circle>



  </agm-map>

  <!-- fab placed to the top and start and on the bottom edge of the content overlapping footer with a list to the right -->
  <ion-fab *ngIf="this.userData?.favorites?.length !== 0" color="dark" id="fab-top" vertical="top" horizontal="start"
    edge slot="fixed">
    <ion-fab-button>
      <ion-icon src="assets/map/star-black.svg"></ion-icon>
    </ion-fab-button>
    <ion-fab-list side="bottom">
      <ion-fab-button (click)="requestForm(fav)" *ngFor="let fav of userData?.favorites">
        <ion-icon [src]="'assets/map/'.concat(fav).concat('.svg')"></ion-icon>
      </ion-fab-button>
    </ion-fab-list>
  </ion-fab>

  <ion-fab *ngIf="origin && destination" id="fab-top" vertical="top" horizontal="end" edge slot="fixed">
    <ion-fab-button (click)="stopDirecting()">
      <ion-icon src="assets/mapIcons/close.svg"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- fab placed to the bottom and start and on the bottom edge of the content overlapping footer with a list to the right -->
  <ion-fab id="fab-bottom" vertical="bottom" horizontal="end" edge slot="fixed">
    <ion-fab-button (click)="openSpotReportsModal()">
      <ion-icon src="assets/mapIcons/alert.svg"></ion-icon>
    </ion-fab-button>
  </ion-fab>


</ion-content>